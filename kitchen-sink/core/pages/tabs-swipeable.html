<template>
  <div class="page no-toolbar">
    <div class="navbar">
      <div class="navbar-bg"></div>
      <div class="navbar-inner sliding">
        <div class="left">
            <a href="#" class="link back">
              <i class="icon icon-back"></i>
              <span class="if-not-md">返回</span>
            </a>
          </div>
        <div class="title">Swipeable Tabs</div>
      </div>
    </div>
    <div class="toolbar toolbar-bottom tabbar">
      <div class="toolbar-inner">
        <a href="#tab-1" class="tab-link tab-link-active">Tab 1</a>
        <a href="#tab-2" class="tab-link">Tab 2</a>
        <a href="#tab-3" class="tab-link">Tab 3</a>
      </div>
    </div>
    <div class="tabs-swipeable-wrap">
      <div class="tabs">
        <div id="tab-1" class="page-content hide-toolbar-on-scroll hide-navbar-on-scroll tab tab-active infinite-scroll-content" data-infinite-distance="50" @infinite="loadMore1">
          <div class="block-title">Scroll bottom</div>
          <div class="list medium-inset simple-list">
            <ul>
              {{#each items1}}
              <li key="{{@index}}">Item {{this}}</li>
              {{/each}}
            </ul>
          </div>
          {{#if hasMoreItems1}}
          <div class="preloader infinite-scroll-preloader"></div>
          {{/if}}
        </div>
        <div id="tab-2" class="page-content hide-toolbar-on-scroll hide-navbar-on-scroll tab infinite-scroll-content" data-infinite-distance="50" @infinite="loadMore2">
          <div class="block-title">Scroll bottom</div>
          <div class="list medium-inset simple-list">
            <ul>
              {{#each items2}}
              <li key="{{@index}}">Item {{this}}</li>
              {{/each}}
            </ul>
          </div>
          {{#if hasMoreItems2}}
          <div class="preloader infinite-scroll-preloader"></div>
          {{/if}}
        </div>
        <div id="tab-3" class="page-content hide-toolbar-on-scroll hide-navbar-on-scroll tab infinite-scroll-content" data-infinite-distance="50" @infinite="loadMore3">
          <div class="block-title">Scroll bottom</div>
          <div class="list medium-inset simple-list">
            <ul>
              {{#each items3}}
              <li key="{{@index}}">Item {{this}}</li>
              {{/each}}
            </ul>
          </div>
          {{#if hasMoreItems3}}
          <div class="preloader infinite-scroll-preloader"></div>
          {{/if}}
        </div>
      </div>
    </div>
  </div>
  </template>
  <script>
    return {
      data: function () {
        return {
          allowInfinite1: true,
          hasMoreItems1: true,
          lastItem1: 20,
          items1: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],

          allowInfinite2: true,
          hasMoreItems2: true,
          lastItem2: 20,
          items2: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],

          allowInfinite3: true,
          hasMoreItems3: true,
          lastItem3: 20,
          items3: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],
        }
      },
      methods: {
        loadMore1: function () {
          var self = this;

          var $ = self.$$;
          if (!self.allowInfinite1) return;
          self.allowInfinite1 = false;

          setTimeout(function () {
            if (self.lastItem1 >= 200) {
              self.$setState({
                hasMoreItems1: false,
              });
              return;
            }

            for (var i = 1; i <= 20; i++) {
              self.items1.push(self.lastItem1 + i);
            }

            self.allowInfinite1 = true;

            self.$setState({
              lastItem1: self.lastItem1 + 20,
              items1: self.items1,
            })
          }, 1000);
        },
        loadMore2: function () {
          var self = this;

          var $ = self.$$;
          if (!self.allowInfinite2) return;
          self.allowInfinite2 = false;

          setTimeout(function () {
          if (self.lastItem2 >= 200) {
            self.$setState({
              hasMoreItems2: false,
            });
            return;
          }

          for (var i = 1; i <= 20; i++) {
            self.items2.push(self.lastItem2 + i);
          }

          self.allowInfinite2 = true;

          self.$setState({
            lastItem2: self.lastItem2 + 20,
            items2: self.items2,
          })
        }, 1000);
      },
      loadMore3: function () {
        var self = this;

        var $ = self.$$;
        if (!self.allowInfinite3) return;
        self.allowInfinite3 = false;

        setTimeout(function () {
          if (self.lastItem3 >= 200) {
            self.$setState({
              hasMoreItems3: false,
            });
            return;
          }

          for (var i = 1; i <= 20; i++) {
            self.items3.push(self.lastItem3 + i);
          }

          self.allowInfinite3 = true;

          self.$setState({
            lastItem3: self.lastItem3 + 20,
            items3: self.items3,
          })
        }, 1000);
      },
    }
  }
</script>